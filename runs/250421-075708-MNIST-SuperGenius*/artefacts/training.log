2025-04-21 07:57:08,381 - INFO - Started logging to ./runs/250421-075708/artefacts/training.log
2025-04-21 07:57:08,381 - INFO - Config file: cfgs/mnist.yaml
2025-04-21 07:57:08,381 - INFO - ==== Config file's contents ====
2025-04-21 07:57:08,381 - INFO - general:
2025-04-21 07:57:08,381 - INFO -   seed: 2024
2025-04-21 07:57:08,381 - INFO -   train: True
2025-04-21 07:57:08,381 - INFO -   dataset: mnist
2025-04-21 07:57:08,381 - INFO -   data_path: ./data/
2025-04-21 07:57:08,381 - INFO -   save_path: None
2025-04-21 07:57:08,381 - INFO - data:
2025-04-21 07:57:08,381 - INFO -   downsample_factor: 1
2025-04-21 07:57:08,381 - INFO -   resolution: [32, 32]
2025-04-21 07:57:08,381 - INFO -   traj_length: 1000
2025-04-21 07:57:08,381 - INFO - model:
2025-04-21 07:57:08,381 - INFO -   mlp_width_size: 24
2025-04-21 07:57:08,381 - INFO -   mlp_depth: 3
2025-04-21 07:57:08,381 - INFO -   activation: relu
2025-04-21 07:57:08,381 - INFO -   input_prev_data: False
2025-04-21 07:57:08,381 - INFO -   model_type: wsm
2025-04-21 07:57:08,381 - INFO -   nb_rnn_layers: 1
2025-04-21 07:57:08,381 - INFO -   weights_lim: 0.5
2025-04-21 07:57:08,381 - INFO -   apply_dynamic_tanh: True
2025-04-21 07:57:08,381 - INFO -   time_as_channel: False
2025-04-21 07:57:08,381 - INFO -   forcing_prob: 0.15
2025-04-21 07:57:08,381 - INFO -   noise_theta_init: None
2025-04-21 07:57:08,382 - INFO -   std_lower_bound: 0.5
2025-04-21 07:57:08,382 - INFO - optimizer:
2025-04-21 07:57:08,382 - INFO -   init_lr: 0.0001
2025-04-21 07:57:08,382 - INFO -   gradients_lim: 1e-07
2025-04-21 07:57:08,382 - INFO -   on_plateau: {'factor': 0.5, 'min_scale': 0.01, 'patience': 20, 'cooldown': 0, 'rtol': 0.0001, 'accum_size': 50}
2025-04-21 07:57:08,382 - INFO - training:
2025-04-21 07:57:08,382 - INFO -   nb_epochs: 500
2025-04-21 07:57:08,382 - INFO -   batch_size: 640
2025-04-21 07:57:08,382 - INFO -   print_every: 10
2025-04-21 07:57:08,382 - INFO -   checkpoint_every: 10
2025-04-21 07:57:08,382 - INFO -   nb_recons_loss_steps: 400
2025-04-21 07:57:08,382 - INFO -   use_nll_loss: True
2025-04-21 07:57:08,382 - INFO -   inference_start: 300
2025-04-21 07:57:11,179 - INFO - Input sequence shape: (640, 784, 1)
2025-04-21 07:57:11,179 - INFO - Labels/OutputSequence shape: (640,)
2025-04-21 07:57:11,179 - INFO - Seq length: 784
2025-04-21 07:57:11,179 - INFO - Data size: 1
2025-04-21 07:57:11,179 - INFO - Min/Max in the dataset: (-1.0, 1.0)
2025-04-21 07:57:11,179 - INFO - Number of batches:
2025-04-21 07:57:11,179 - INFO -   - Train: 94
2025-04-21 07:57:11,179 - INFO -   - Test: 16
2025-04-21 07:57:12,471 - INFO - No model found in run folder. Training from scratch.
2025-04-21 07:57:12,471 - INFO - 

=== Beginning training ... ===
2025-04-21 07:57:12,471 - INFO -   - Number of epochs: 500
2025-04-21 07:57:12,471 - INFO -   - Number of batches: 94
2025-04-21 07:57:12,471 - INFO -   - Total number of GD steps: 47000
2025-04-21 07:57:57,106 - INFO - Epoch    0/ 500     Train Loss   -Mean: 0.491370,   -Median: 0.185181,   -Latest: 0.091057
2025-04-21 07:57:57,127 - INFO - Best model saved ...
2025-04-21 07:58:22,919 - INFO - Epoch    1/ 500     Train Loss   -Mean: 0.119961,   -Median: 0.087157,   -Latest: -0.053141
2025-04-21 07:58:48,842 - INFO - Epoch    2/ 500     Train Loss   -Mean: -0.056397,   -Median: -0.061562,   -Latest: -0.047771
2025-04-21 07:59:14,689 - INFO - Epoch    3/ 500     Train Loss   -Mean: -0.119767,   -Median: -0.126171,   -Latest: -0.227378
2025-04-21 08:02:16,376 - INFO - Epoch   10/ 500     Train Loss   -Mean: -0.153152,   -Median: -0.156987,   -Latest: -0.009666
2025-04-21 08:02:16,418 - INFO - Best model saved ...
2025-04-21 08:06:33,864 - INFO - Epoch   20/ 500     Train Loss   -Mean: -0.285509,   -Median: -0.285922,   -Latest: -0.257807
2025-04-21 08:06:33,940 - INFO - Best model saved ...
2025-04-21 08:10:53,436 - INFO - Epoch   30/ 500     Train Loss   -Mean: -0.304741,   -Median: -0.303218,   -Latest: -0.336191
2025-04-21 08:10:53,493 - INFO - Best model saved ...
2025-04-21 08:15:12,370 - INFO - Epoch   40/ 500     Train Loss   -Mean: -0.318776,   -Median: -0.323005,   -Latest: -0.322415
2025-04-21 08:15:12,447 - INFO - Best model saved ...
2025-04-21 08:19:31,578 - INFO - Epoch   50/ 500     Train Loss   -Mean: -0.301540,   -Median: -0.306627,   -Latest: -0.279124
2025-04-21 08:23:51,465 - INFO - Epoch   60/ 500     Train Loss   -Mean: -0.339032,   -Median: -0.340380,   -Latest: -0.352604
2025-04-21 08:23:51,544 - INFO - Best model saved ...
2025-04-21 08:28:12,514 - INFO - Epoch   70/ 500     Train Loss   -Mean: -0.372182,   -Median: -0.375234,   -Latest: -0.366060
2025-04-21 08:28:12,592 - INFO - Best model saved ...
2025-04-21 08:32:33,414 - INFO - Epoch   80/ 500     Train Loss   -Mean: -0.380686,   -Median: -0.383753,   -Latest: -0.364211
2025-04-21 08:32:33,497 - INFO - Best model saved ...
2025-04-21 08:36:53,419 - INFO - Epoch   90/ 500     Train Loss   -Mean: -0.389350,   -Median: -0.394428,   -Latest: -0.374978
2025-04-21 08:36:53,509 - INFO - Best model saved ...
2025-04-21 08:41:12,831 - INFO - Epoch  100/ 500     Train Loss   -Mean: -0.375532,   -Median: -0.385282,   -Latest: -0.380105
2025-04-21 08:45:32,179 - INFO - Epoch  110/ 500     Train Loss   -Mean: -0.400543,   -Median: -0.402001,   -Latest: -0.399178
2025-04-21 08:45:32,287 - INFO - Best model saved ...
2025-04-21 08:49:51,155 - INFO - Epoch  120/ 500     Train Loss   -Mean: -0.402474,   -Median: -0.404186,   -Latest: -0.392182
2025-04-21 08:49:51,263 - INFO - Best model saved ...
2025-04-21 08:54:11,712 - INFO - Epoch  130/ 500     Train Loss   -Mean: -0.404729,   -Median: -0.407830,   -Latest: -0.415379
2025-04-21 08:54:11,833 - INFO - Best model saved ...
2025-04-21 08:58:30,839 - INFO - Epoch  140/ 500     Train Loss   -Mean: -0.408761,   -Median: -0.408971,   -Latest: -0.406126
2025-04-21 08:58:30,964 - INFO - Best model saved ...
2025-04-21 09:02:50,850 - INFO - Epoch  150/ 500     Train Loss   -Mean: -0.413453,   -Median: -0.416019,   -Latest: -0.416440
2025-04-21 09:02:50,981 - INFO - Best model saved ...
2025-04-21 09:07:11,554 - INFO - Epoch  160/ 500     Train Loss   -Mean: -0.422893,   -Median: -0.425147,   -Latest: -0.430600
2025-04-21 09:07:11,705 - INFO - Best model saved ...
2025-04-21 09:11:32,180 - INFO - Epoch  170/ 500     Train Loss   -Mean: -0.420537,   -Median: -0.420213,   -Latest: -0.423653
2025-04-21 09:15:51,532 - INFO - Epoch  180/ 500     Train Loss   -Mean: -0.421741,   -Median: -0.424927,   -Latest: -0.429456
2025-04-21 09:20:12,143 - INFO - Epoch  190/ 500     Train Loss   -Mean: -0.449725,   -Median: -0.449432,   -Latest: -0.454915
2025-04-21 09:20:12,301 - INFO - Best model saved ...
2025-04-21 09:24:33,080 - INFO - Epoch  200/ 500     Train Loss   -Mean: -0.448559,   -Median: -0.449860,   -Latest: -0.456241
2025-04-21 09:24:33,243 - INFO - Best model saved ...
2025-04-21 09:28:53,415 - INFO - Epoch  210/ 500     Train Loss   -Mean: -0.452490,   -Median: -0.452320,   -Latest: -0.459921
2025-04-21 09:28:53,579 - INFO - Best model saved ...
2025-04-21 09:33:14,001 - INFO - Epoch  220/ 500     Train Loss   -Mean: -0.450764,   -Median: -0.451639,   -Latest: -0.456427
2025-04-21 09:37:34,741 - INFO - Epoch  230/ 500     Train Loss   -Mean: -0.462719,   -Median: -0.463441,   -Latest: -0.467566
2025-04-21 09:37:35,149 - INFO - Best model saved ...
2025-04-21 09:41:56,685 - INFO - Epoch  240/ 500     Train Loss   -Mean: -0.465064,   -Median: -0.465040,   -Latest: -0.467241
2025-04-21 09:41:56,870 - INFO - Best model saved ...
2025-04-21 09:46:40,199 - INFO - Epoch  250/ 500     Train Loss   -Mean: -0.467129,   -Median: -0.467241,   -Latest: -0.467298
2025-04-21 09:46:40,379 - INFO - Best model saved ...
2025-04-21 09:53:14,161 - INFO - Epoch  260/ 500     Train Loss   -Mean: -0.468450,   -Median: -0.468226,   -Latest: -0.471459
2025-04-21 09:53:14,386 - INFO - Best model saved ...
Mon Apr 21 07:59:14 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.124.06             Driver Version: 570.124.06     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 4080        On  |   00000000:01:00.0 Off |                  N/A |
| 32%   53C    P0            183W /  320W |   14767MiB /  16376MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A            2612      G   /usr/lib/xorg/Xorg                       97MiB |
|    0   N/A  N/A            2674      G   /usr/bin/gnome-shell                      8MiB |
|    0   N/A  N/A         2921452      C   python                                14626MiB |
+-----------------------------------------------------------------------------------------+
2025-04-21 09:57:34,846 - INFO - Epoch  270/ 500     Train Loss   -Mean: -0.470714,   -Median: -0.470742,   -Latest: -0.468833
2025-04-21 09:57:35,055 - INFO - Best model saved ...
2025-04-21 10:01:55,198 - INFO - Epoch  280/ 500     Train Loss   -Mean: -0.473117,   -Median: -0.473420,   -Latest: -0.470279
2025-04-21 10:01:55,396 - INFO - Best model saved ...
2025-04-21 10:06:15,578 - INFO - Epoch  290/ 500     Train Loss   -Mean: -0.473956,   -Median: -0.473928,   -Latest: -0.477766
2025-04-21 10:06:15,799 - INFO - Best model saved ...
2025-04-21 10:11:09,962 - INFO - Epoch  300/ 500     Train Loss   -Mean: -0.474636,   -Median: -0.474410,   -Latest: -0.469293
2025-04-21 10:11:10,246 - INFO - Best model saved ...
2025-04-21 10:15:31,336 - INFO - Epoch  310/ 500     Train Loss   -Mean: -0.477269,   -Median: -0.477401,   -Latest: -0.474368
2025-04-21 10:15:31,602 - INFO - Best model saved ...
2025-04-21 10:19:50,495 - INFO - Epoch  320/ 500     Train Loss   -Mean: -0.477541,   -Median: -0.477674,   -Latest: -0.474285
2025-04-21 10:19:50,741 - INFO - Best model saved ...
2025-04-21 10:24:10,245 - INFO - Epoch  330/ 500     Train Loss   -Mean: -0.478488,   -Median: -0.478617,   -Latest: -0.475421
2025-04-21 10:24:10,512 - INFO - Best model saved ...
2025-04-21 10:28:30,926 - INFO - Epoch  340/ 500     Train Loss   -Mean: -0.479034,   -Median: -0.479431,   -Latest: -0.481978
2025-04-21 10:28:31,185 - INFO - Best model saved ...
2025-04-21 10:32:51,201 - INFO - Epoch  350/ 500     Train Loss   -Mean: -0.479155,   -Median: -0.479205,   -Latest: -0.482159
2025-04-21 10:37:10,401 - INFO - Epoch  360/ 500     Train Loss   -Mean: -0.479218,   -Median: -0.479235,   -Latest: -0.476555
2025-04-21 10:41:29,790 - INFO - Epoch  370/ 500     Train Loss   -Mean: -0.479393,   -Median: -0.479435,   -Latest: -0.483981
2025-04-21 10:41:30,061 - INFO - Best model saved ...
2025-04-21 10:45:50,168 - INFO - Epoch  380/ 500     Train Loss   -Mean: -0.479960,   -Median: -0.480115,   -Latest: -0.487698
2025-04-21 10:45:50,448 - INFO - Best model saved ...
2025-04-21 10:50:09,507 - INFO - Epoch  390/ 500     Train Loss   -Mean: -0.480785,   -Median: -0.480799,   -Latest: -0.478062
2025-04-21 10:50:09,811 - INFO - Best model saved ...
2025-04-21 10:54:29,468 - INFO - Epoch  400/ 500     Train Loss   -Mean: -0.480172,   -Median: -0.480336,   -Latest: -0.482949
2025-04-21 10:58:49,252 - INFO - Epoch  410/ 500     Train Loss   -Mean: -0.480649,   -Median: -0.480532,   -Latest: -0.477962
2025-04-21 11:03:11,377 - INFO - Epoch  420/ 500     Train Loss   -Mean: -0.480680,   -Median: -0.480698,   -Latest: -0.480991
2025-04-21 11:07:30,508 - INFO - Epoch  430/ 500     Train Loss   -Mean: -0.482522,   -Median: -0.482724,   -Latest: -0.486121
2025-04-21 11:07:30,826 - INFO - Best model saved ...
2025-04-21 11:11:51,505 - INFO - Epoch  440/ 500     Train Loss   -Mean: -0.483125,   -Median: -0.483342,   -Latest: -0.486090
2025-04-21 11:11:51,800 - INFO - Best model saved ...
2025-04-21 11:16:12,945 - INFO - Epoch  450/ 500     Train Loss   -Mean: -0.483031,   -Median: -0.483094,   -Latest: -0.479591
2025-04-21 11:20:33,392 - INFO - Epoch  460/ 500     Train Loss   -Mean: -0.483432,   -Median: -0.483213,   -Latest: -0.479754
2025-04-21 11:24:53,775 - INFO - Epoch  470/ 500     Train Loss   -Mean: -0.483547,   -Median: -0.483529,   -Latest: -0.482857
2025-04-21 11:24:54,115 - INFO - Best model saved ...
2025-04-21 11:29:13,901 - INFO - Epoch  480/ 500     Train Loss   -Mean: -0.483692,   -Median: -0.483798,   -Latest: -0.485913
2025-04-21 11:29:14,254 - INFO - Best model saved ...
2025-04-21 11:33:35,023 - INFO - Epoch  490/ 500     Train Loss   -Mean: -0.483521,   -Median: -0.483913,   -Latest: -0.483601
2025-04-21 11:33:35,376 - INFO - Best model saved ...
2025-04-21 11:37:29,543 - INFO - Epoch  499/ 500     Train Loss   -Mean: -0.483699,   -Median: -0.483836,   -Latest: -0.486268
2025-04-21 11:37:29,902 - INFO - 
Training complete. Total time: 3 hours 40 mins 17 secs
2025-04-21 11:37:35,151 - INFO - Evaluation of MSE on the test set, at the end of the training (Current Best Model):
2025-04-21 11:37:35,151 - INFO -     - Mean : 0.118917
2025-04-21 11:37:35,151 - INFO -     - Median : 0.118909
2025-04-21 11:37:35,151 - INFO -     - Min : 0.115918
2025-04-21 11:37:35,152 - INFO - Checkpoints MSE artefact file found. Loading it.
